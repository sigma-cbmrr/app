<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="logo_sigma.png" onerror="this.onerror=null; this.src='https://placehold.co/16x16/800020/ffffff?text=S'">
    <title>SIGMA - Gestão & Comando</title>
    
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* --- ESTILOS GERAIS --- */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f9; color: #333; margin: 0; display: flex; min-height: 100vh; }
        .main-header { background-color: #800020; color: white; padding: 10px 20px; position: fixed; top: 0; left: 0; width: 100%; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); z-index: 100; display: flex; justify-content: space-between; align-items: center; height: 50px; box-sizing: border-box; }
        .main-header h1 { margin: 0; font-size: 1.5em; cursor: pointer; }
        .content-area { margin-top: 50px; padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
        .view-section { display: none; margin-bottom: 20px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); }
        .view-section h1 { color: #800020; border-bottom: 2px solid #ccc; padding-bottom: 10px; margin-bottom: 20px; font-size: 1.8em; }
        
        /* --- NAVEGAÇÃO --- */
        .nav-links { display: flex; gap: 20px; }
        .nav-links button { background: none; border: none; color: white; font-size: 1em; cursor: pointer; padding: 5px 10px; border-radius: 4px; transition: background-color 0.3s; }
        .nav-links button:hover, .nav-links button.active { background-color: #6a001a; }

        /* --- FILTROS & AÇÕES --- */
        .filter-area { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-input { width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 6px; font-size: 0.95em; box-sizing: border-box; }
        .btn-modern-action { background-color: #800020; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; transition: background-color 0.3s, transform 0.1s; font-weight: bold; }
        .btn-modern-action:hover { background-color: #6a001a; transform: translateY(-1px); }
        .btn-create { background-color: #28a745; }
        .btn-create:hover { background-color: #218838; }
        .btn-sync { background-color: #007bff; }
        .btn-sync:hover { background-color: #0056b3; }
        .btn-alert { background-color: #dc3545; }
        .btn-alert:hover { background-color: #c82333; }
        .btn-add { background-color: #28a745; color: white; border: none; padding: 0 10px; border-radius: 6px; cursor: pointer; font-weight: bold; transition: background-color 0.3s; }
        .btn-add:hover { background-color: #218838; }
        .btn-remover { background: none; border: none; color: #dc3545; cursor: pointer; font-size: 1em; transition: color 0.3s; }
        .btn-remover:hover { color: #c82333; }
        .btn-edit-alt { background: none; border: none; color: #007bff; cursor: pointer; font-size: 1em; margin-right: 5px; transition: color 0.3s; }
        .btn-edit-alt:hover { color: #0056b3; }

        /* --- MODAL --- */
        .modal { display: none; position: fixed; z-index: 200; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.6); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 500px; position: relative; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); }
        .close-btn { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s; }
        .close-btn:hover, .close-btn:focus { color: #333; text-decoration: none; }
        .modal-content h2 { color: #800020; margin-top: 0; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        .modal-content input[type="text"], .modal-content input[type="number"] { width: 100%; padding: 10px; margin: 8px 0; display: inline-block; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        
        /* --- STATUS BADGES --- */
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; margin-left: 5px; white-space: nowrap; }
        .status-badge.pending { background-color: #ffc107; color: #333; }
        .status-badge.ok { background-color: #28a745; color: white; }
        .status-badge.alert { background-color: #dc3545; color: white; }
        .text-red { color: #dc3545; font-weight: bold; }

        /* --- EDITOR DE LISTAS (ADMIN) --- */
        .admin-container { background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); width: 100%; max-width: 900px; margin: 0 auto; text-align: center; }
        .global-actions { margin-bottom: 0 !important; }
        
        .lista-setores { padding: 0; margin: 0; list-style: none; text-align: left; }
        
        /* REMOVE QUALQUER BORDA E ADICIONA MARGEM CORRETA PARA O UL PRINCIPAL */
        #lista-setores-container {
            border: none !important;
            margin-top: 20px; 
        }

        /* ---------------------------------------------------- */
        
        .setor-item { 
            margin-bottom: 15px; 
            border: 1px solid #800020; 
            border-radius: 6px; 
            background: #fff;
            /* Padding removido para correção de espaçamento excessivo */
        }
        
        /* GARANTE QUE O PRIMEIRO SETOR NÃO EMPURRE PARA BAIXO */
        #lista-setores-container > .setor-item:first-child {
            margin-top: 0 !important;
            border-top: 1px solid #800020; /* Garante que a borda superior exista */
        }

        /* --- STICKY HEADER --- */
        /* Contêiner que se tornará fixo (Sticky) */
        .setor-content-header-sticky {
            position: sticky;
            top: 50px; /* Fica fixo abaixo do main-header */
            z-index: 50; 
            background-color: #fff; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
            transition: background-color 0.3s ease;
        }

        /* O cabeçalho do setor (cor de contraste para o modo sticky) */
        .setor-header-admin { 
            background-color: #D90F23; /* NOVO: Cor de contraste (vermelho vivo) */
            color: white; 
            padding: 10px 15px; 
            display: flex;
            justify-content: space-between; 
            align-items: center; 
            font-weight: bold; 
            cursor: grab;
            z-index: 51; 
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .setor-content-admin { 
            transition: max-height 0.4s ease-out;
            /* NOVO: Padding para compensar o Sticky Header, eliminando espaço excessivo interno */
            padding: 130px 10px 10px; 
            max-height: 500px;
            overflow-y: auto;
        }
        .setor-content-admin.collapsed { max-height: 0; padding: 0 10px; overflow: hidden; }

        /* Formulário de Adição de Item */
        .add-item-form-setor { 
            padding: 10px 15px 10px; 
            background-color: #f8f8f8; 
            display: flex; 
            gap: 5px; 
            align-items: center; 
        }

        /* Lista de Itens */
        .item-list-admin { padding: 0; list-style: none; }
        .item-conferencia-admin { padding: 10px 0; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .item-conferencia-admin:last-child { border-bottom: none; }
        .item-actions-admin { display: flex; align-items: center; }

        /* Tombamentos (no admin) */
        .tombamento-item-admin { display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-top: 1px dashed #eee; font-size: 0.9em; }
        .tombamento-item-admin:first-child { border-top: none; }
        .tombamentos-list { margin-top: 10px; padding: 5px 10px; background-color: #f9f9f9; border-radius: 4px; }

        /* VIEW LISTAS */
        .locais-list { list-style: none; padding: 0; margin-top: 20px; }
        .local-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; border: 1px solid #ccc; margin-bottom: 8px; border-radius: 6px; background: #fff; }
        .local-item span { font-weight: bold; }
        .new-local-section { border: 1px solid #ccc; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="main-header">
        <h1 onclick="alternarView('view-conferencia')">SIGMA</h1>
        <div class="nav-links">
            <button onclick="alternarView('view-conferencia')" id="nav-conferencia" class="active">Conferência</button>
            <button onclick="alternarView('view-listas')" id="nav-listas">Editor de Listas</button>
        </div>
    </div>

    <div class="content-area">
        <div id="view-conferencia" class="view-section" style="display: block;">
            <h1>Conferência</h1>
            <div class="filter-area">
                <select id="select-local-posto" class="filter-input" onchange="carregarLocal(this.value, document.getElementById('select-local-nome').value)"></select>
                <select id="select-local-nome" class="filter-input" onchange="carregarLocal(document.getElementById('select-local-posto').value, this.value)"></select>
                <select id="select-unidade" class="filter-input" onchange="filtrarUnidade(this.value)"><option value="">Todas as Unidades</option></select>
                <button class="btn-modern-action btn-sync" onclick="sincronizarDados()"><i class="fas fa-sync"></i> Sincronizar</button>
                <button class="btn-modern-action btn-create" onclick="gerarRelatorio()"><i class="fas fa-file-pdf"></i> Relatório</button>
            </div>

            <div id="conferencia-content">
                <p>Selecione um local e nome para iniciar a conferência.</p>
            </div>
        </div>

        <div id="view-listas" class="view-section">
            <h1>Editor de Listas</h1>
            <div class="new-local-section">
                <h3>Criar Lista</h3>
                <div style="display:flex; gap:10px; flex-wrap:wrap;">
                    <select id="novo-local-posto" class="filter-input" style="flex:1;"></select>
                    <input type="text" id="novo-local-nome" placeholder="Nome Lista" class="filter-input" style="flex:2;">
                    <select id="novo-local-unidade" class="filter-input" style="flex:1;"><option value="">Associar a Unidade...</option></select>
                    <button class="btn-modern-action btn-create" onclick="criarNovoLocal()">Criar</button>
                </div>
            </div>
            <ul id="lista-locais-container" class="locais-list"></ul>
        </div>

        <div id="view-editor" class="view-section">
            <h1 id="editor-titulo">Editor de Detalhes da Lista</h1>
            <div class="admin-container">
                <div class="global-actions" style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 20px;">
                    <div style="display:flex; gap:10px;">
                        <button class="btn-modern-action btn-sync" onclick="salvarDados(true)"><i class="fas fa-save"></i> Salvar & Publicar</button>
                        <button class="btn-modern-action" onclick="fazerBackup()"><i class="fas fa-download"></i> Backup Local</button>
                        <button class="btn-modern-action btn-alert" onclick="importarBackup()"><i class="fas fa-upload"></i> Importar Backup</button>
                    </div>
                    <div class="add-setor-form" style="display:flex; gap:5px;">
                        <input type="text" id="input-setor-nome" placeholder="Nome Setor" class="filter-input" style="width: 150px;">
                        <button class="btn-add" onclick="adicionarSetor(document.getElementById('input-setor-nome').value)">+ Setor</button>
                    </div>
                </div>
                <ul id="lista-setores-container" class="lista-setores">
                    </ul>
            </div>
        </div>
    </div>

    <div id="modal-edicao" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="fecharModalEdicao()">&times;</span>
            <h2>Editar Item</h2>
            <div id="modal-edicao-body">
                </div>
            <button class="btn-modern-action btn-sync" onclick="salvarEdicaoModal()">Salvar Alterações</button>
        </div>
    </div>

    <script>
        // Variáveis globais
        let dadosLocais = JSON.parse(localStorage.getItem('dadosLocais')) || {};
        let dadosConferencia = null;
        let localAtivoId = null;
        let unidades = JSON.parse(localStorage.getItem('unidades')) || { 'UNID-A': 'Unidade Alfa', 'UNID-B': 'Unidade Beta' };
        
        // --- FUNÇÕES DE NAVEGAÇÃO E UTILS ---

        function alternarView(viewId) {
            document.querySelectorAll('.view-section').forEach(view => view.style.display = 'none');
            document.getElementById(viewId).style.display = 'block';

            document.querySelectorAll('.nav-links button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`nav-${viewId.replace('view-', '')}`).classList.add('active');

            if (viewId === 'view-listas') {
                renderizarLocaisList();
            } else if (viewId === 'view-conferencia') {
                carregarSelectsConferencia();
            }
        }

        function gerarNovoId() {
            return Math.random().toString(36).substring(2, 9);
        }

        function salvarDados(publicar) {
            if (!localAtivoId || !dadosConferencia) return;
            
            // Salva dados locais do editor
            dadosLocais[localAtivoId].setores = dadosConferencia;
            localStorage.setItem('dadosLocais', JSON.stringify(dadosLocais));

            if (publicar) {
                // Aqui você faria a chamada real para o Firestore/Banco de Dados para publicar
                alert(`Dados de ${dadosLocais[localAtivoId].nome} salvos e PUBLICADOS!`);
            } else {
                console.log(`Dados de ${dadosLocais[localAtivoId].nome} salvos localmente.`);
            }
        }
        
        // ... (Funções de Backup e Sincronização - Omissas para foco) ...

        // --- FUNÇÕES DE LISTA DE LOCAIS (VIEW-LISTAS) ---

        function criarNovoLocal() {
            const posto = document.getElementById('novo-local-posto').value.trim();
            const nome = document.getElementById('novo-local-nome').value.trim();
            const unidade = document.getElementById('novo-local-unidade').value.trim() || null;

            if (!posto || !nome) {
                return alert('Preencha Posto e Nome da Lista.');
            }

            const novoId = gerarNovoId();
            dadosLocais[novoId] = {
                id: novoId,
                posto: posto,
                nome: nome,
                unidade: unidade,
                setores: []
            };

            localStorage.setItem('dadosLocais', JSON.stringify(dadosLocais));

            document.getElementById('novo-local-nome').value = '';
            renderizarLocaisList();
            renderizarSelectsConferencia();
        }

        function editarLocal(id) {
            const local = dadosLocais[id];
            const novoNome = prompt(`Novo nome para "${local.nome}":`, local.nome);
            if (novoNome && novoNome.trim() !== local.nome) {
                local.nome = novoNome.trim();
                localStorage.setItem('dadosLocais', JSON.stringify(dadosLocais));
                renderizarLocaisList();
                renderizarSelectsConferencia();
            }
        }

        function removerLocal(id) {
            if (confirm(`Tem certeza que deseja remover a lista "${dadosLocais[id].nome}"?`)) {
                delete dadosLocais[id];
                localStorage.setItem('dadosLocais', JSON.stringify(dadosLocais));
                renderizarLocaisList();
                renderizarSelectsConferencia();
                if (localAtivoId === id) {
                    localAtivoId = null;
                    dadosConferencia = null;
                    alternarView('view-conferencia');
                }
            }
        }

        function renderizarLocaisList() {
            const container = document.getElementById('lista-locais-container');
            container.innerHTML = '';
            
            const postos = [...new Set(Object.values(dadosLocais).map(l => l.posto))].sort();
            const postoSelect = document.getElementById('novo-local-posto');
            postoSelect.innerHTML = '<option value="">Selecione Posto...</option>' + postos.map(p => `<option value="${p}">${p}</option>`).join('');

            Object.values(dadosLocais).sort((a, b) => a.posto.localeCompare(b.posto) || a.nome.localeCompare(b.nome)).forEach(local => {
                const li = document.createElement('li');
                li.className = 'local-item';
                li.innerHTML = `
                    <span>${local.posto} - ${local.nome} ${local.unidade ? `(${unidades[local.unidade] || local.unidade})` : ''}</span>
                    <div>
                        <button class="btn-edit-alt" onclick="abrirEditor('${local.id}')"><i class="fas fa-edit"></i> Editar Detalhes</button>
                        <button class="btn-edit-alt" onclick="editarLocal('${local.id}')"><i class="fas fa-pen"></i></button>
                        <button class="btn-remover" onclick="removerLocal('${local.id}')"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                container.appendChild(li);
            });
        }
        
        // --- FUNÇÕES DE EDIÇÃO DE DETALHES (VIEW-EDITOR) ---

        function abrirEditor(id) {
            localAtivoId = id;
            dadosConferencia = dadosLocais[id].setores;
            document.getElementById('editor-titulo').textContent = `Editor de Detalhes da Lista: ${dadosLocais[id].nome}`;
            renderizarLista();
            alternarView('view-editor');
        }

        function adicionarSetor(nome) {
            const n = nome.trim().toUpperCase();
            if (!n) return;
            dadosConferencia.push({ id: gerarNovoId(), nome: n, itens: [] });
            document.getElementById('input-setor-nome').value = '';
            salvarDados(false);
            renderizarLista();
        }

        function removerSetor(sid) {
            if (!confirm("Tem certeza que deseja remover este setor e todos os seus itens?")) return;
            dadosConferencia = dadosConferencia.filter(s => s.id !== sid);
            salvarDados(false);
            renderizarLista();
        }

        // FUNÇÃO ANTIGA DE ADICIONAR ITEM (MANTIDA PARA A PRÓXIMA ETAPA)
        function adicionarItemPorSetor(sid) { 
            const n = document.getElementById('input-item-nome-'+sid).value.trim().toUpperCase(); 
            const q = parseInt(document.getElementById('input-item-qtd-'+sid).value); 
            const t = document.getElementById('select-item-tipo-'+sid).value; 
            
            if(!n || q < 1) return; 

            // CAPTURAR O SCROLL POSITION ANTES DA RECONSTRUÇÃO DO DOM
            const scrollContainer = document.querySelector('.admin-container'); 
            let scrollTop = scrollContainer ? scrollContainer.scrollTop : 0;
            
            const s = dadosConferencia.find(x => x.id === sid);
            const novo = {id: sid+'-'+gerarNovoId(), nome: n, quantidadeEsperada: q, tipo: t, tombamentos:[]}; 
            
            if(t === 'multi') for(let i = 0; i < q; i++) novo.tombamentos.push({tomb: 'NOVO-' + (i+1), status: 'pending', obs: ''}); 
            
            s.itens.push(novo); 
            
            document.getElementById('input-item-nome-'+sid).value = '';

            salvarDados(false); 
            
            // RECONSTRUIR A LISTA
            renderizarLista(); 

            // RESTAURAR O SCROLL POSITION APÓS A RECONSTRUÇÃO
            if (scrollContainer && scrollTop > 0) {
                setTimeout(() => {
                    scrollContainer.scrollTop = scrollTop;
                }, 50); 
            }
        }
        
        function removerItem(sid, iid) {
            if (!confirm("Tem certeza que deseja remover este item?")) return;
            const s = dadosConferencia.find(x => x.id === sid);
            s.itens = s.itens.filter(i => i.id !== iid);
            salvarDados(false);
            renderizarLista();
        }

        function updateOrdens() {
            const container = document.getElementById('lista-setores-container');
            const setoresReordenados = [];
            
            // 1. Reordena Setores
            Array.from(container.children).forEach(setorEl => {
                const setorId = setorEl.dataset.id;
                const setor = dadosConferencia.find(s => s.id === setorId);

                // 2. Reordena Itens dentro do Setor
                const itemListEl = setorEl.querySelector('.item-list-admin');
                if (itemListEl) {
                    const itensReordenados = [];
                    Array.from(itemListEl.children).forEach(itemLi => {
                        const itemId = itemLi.dataset.id;
                        const item = setor.itens.find(i => i.id === itemId);
                        if (item) itensReordenados.push(item);
                    });
                    setor.itens = itensReordenados;
                }
                setoresReordenados.push(setor);
            });
            dadosConferencia = setoresReordenados;
        }

        function renderizarLista() {
            const container = document.getElementById('lista-setores-container');
            container.innerHTML = '';

            if (dadosConferencia) {
                dadosConferencia.forEach(setor => {
                    const setorLi = document.createElement('li');
                    setorLi.className = 'setor-item';
                    setorLi.dataset.id = setor.id;

                    let itensHtml = '';
                    setor.itens.forEach(item => {
                        let tombamentosHtml = '';
                        if (item.tipo === 'multi' && item.tombamentos && item.tombamentos.length > 0) {
                            tombamentosHtml = `<div class="tombamentos-list">`;
                            item.tombamentos.forEach(tomb => {
                                const statusClass = tomb.status === 'ok' ? 'ok' : (tomb.status === 'alert' ? 'alert' : 'pending');
                                tombamentosHtml += `<div class="tombamento-item-admin"><span>${tomb.tomb}</span><span class="status-badge ${statusClass}">${tomb.status.toUpperCase()}</span></div>`;
                            });
                            tombamentosHtml += `</div>`;
                        }
                        itensHtml += `
                            <li class="item-conferencia-admin" data-id="${item.id}">
                                <div style="width:100%">
                                    <div style="display:flex;justify-content:space-between;">
                                        <div><strong>${item.nome}</strong><small> Qtd: ${item.quantidadeEsperada}</small></div>
                                        <div class="item-actions-admin">
                                            <button class="btn-edit-alt" onclick="abrirModalEdicao('${setor.id}','${item.id}')"><i class="fas fa-edit"></i></button>
                                            <button class="btn-remover" onclick="removerItem('${setor.id}','${item.id}')"><i class="fas fa-trash"></i></button>
                                        </div>
                                    </div>
                                    ${item.tipo === 'multi' ? tombamentosHtml : ''}
                                </div>
                            </li>
                        `;
                    });

                    // Antigo formulário de adição (Será substituído na próxima etapa)
                    const addItemFormHtml = `
                        <div class="add-item-form-setor">
                            <input type="text" id="input-item-nome-${setor.id}" placeholder="Item" class="filter-input" style="flex-grow:1;">
                            <input type="number" id="input-item-qtd-${setor.id}" value="1" class="filter-input" style="width:70px; flex-grow:0;">
                            <select id="select-item-tipo-${setor.id}" class="filter-input" style="flex-grow:1;">
                                <option value="single">Único</option>
                                <option value="multi">Tombamento</option>
                            </select>
                            <button class="btn-add" onclick="adicionarItemPorSetor('${setor.id}')" style="padding: 10px 15px;">+</button>
                        </div>
                    `;
                    
                    // NOVO: Estrutura do Sticky Header
                    setorLi.innerHTML = `
                        <div class="setor-content-header-sticky">
                            <div class="setor-header-admin" onclick="this.parentNode.nextElementSibling.classList.toggle('collapsed')">
                                <span>${setor.nome}</span>
                                <button class="btn-remover" onclick="event.stopPropagation();removerSetor('${setor.id}')">X</button>
                            </div>
                            ${addItemFormHtml}
                        </div>
                        <div class="setor-content-admin">
                            <ul class="lista-setores item-list-admin" data-setor-id="${setor.id}">${itensHtml}</ul>
                        </div>
                    `;
                    
                    container.appendChild(setorLi);
                });
                
                // Inicialização do Sortable para SETORES 
                new Sortable(container, { 
                    animation: 150, 
                    handle: '.setor-header-admin', 
                    onEnd: () => { 
                        updateOrdens(); 
                        salvarDados(false); 
                    } 
                });
                
                // Inicialização do Sortable para ITENS
                document.querySelectorAll('.item-list-admin').forEach(el => { 
                    new Sortable(el, { 
                        group: 'items', 
                        animation: 150, 
                        scroll: true, 
                        scrollSensitivity: 80,    
                        scrollSpeed: 20,          
                        bubbleScroll: true,
                        onEnd: () => { 
                            updateOrdens(); 
                            salvarDados(false); 
                        } 
                    }); 
                });
            }
        }

        // ... (Resto das funções omitidas para brevidade: abrirModalEdicao, salvarEdicaoModal, etc.) ...
        
        // --- INICIALIZAÇÃO ---
        window.onload = () => {
            document.getElementById('nav-conferencia').click(); 
        };
    </script>
</body>
</html>
